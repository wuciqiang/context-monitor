---
description: 拆分任务并开始实施（Phase 3-4）
---

# 任务拆分与实施

⚠️ **高级用法** - 此命令需要先完成 Phase 0-2。推荐使用 `/cm:auto` 自动执行完整流程。

## 前置检查

在执行此命令前，请确认：
- ✅ 已完成 Phase 2 分析（`/cm:analyze`）
- ✅ 实施方案已确认
- ✅ 上下文使用率 < 70%

如未满足，请运行 `/cm:auto` 代替此命令。

---

执行 Phase 3-4：原型获取与编码实施

## Phase 3: 原型获取

1. **上下文检查**
   - 调用 `check_context_usage` 检查使用率
   - 如果 > 70%，先保存状态

2. **选择路由**
   - **Route A (前端/UI)**：调用 Gemini skill
   - **Route B (后端/逻辑)**：调用 Codex skill
   - 要求返回 Unified Diff Patch

## Phase 4: 编码实施

3. **任务原子化** (强制)
   - **必须**将任务拆分为原子级任务
   - 每个原子任务：
     * 最多涉及 3 个文件
     * 单一职责（只做一件事）
     * 可独立测试
     * 预计 10-30 分钟完成
   - 使用 `TodoWrite` 工具记录所有任务
   - **验证**: 如果任务描述超过 1 行，继续拆分

4. **逐步实施** (严格执行)
   - 按顺序实施每个原子任务
   - **每完成 1 个原子任务**:
     1. 立即标记为 completed
     2. 调用 `check_context_usage`
     3. 如使用率 > 70%: 保存状态 → 提示 `/clear` → 停止
     4. 如使用率 < 70%: 继续下一个任务
   - **每 5-10 个工具调用**: 自动检查上下文
   - **目标**: 保持纯净上下文，减少 AI 幻觉

5. **代码重构**
   - 基于原型重写为企业级代码
   - 精简高效，非必要不添加注释
   - 变更仅限需求范围
   - 强制审查是否引入副作用

**输出**：企业级生产代码 + 任务完成清单
