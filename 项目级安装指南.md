# é¡¹ç›®çº§å®‰è£…æŒ‡å—
# Project-Level Installation Guide

> å°† Context Monitor å®‰è£…åˆ°æŒ‡å®šé¡¹ç›®

---

## ğŸš€ ä¸€é”®å®‰è£…

### Windows (PowerShell)

```powershell
# æ–¹å¼ 1: äº¤äº’å¼å®‰è£…ï¼ˆæ¨èï¼‰
cd F:\LayaAir-GitHub\context-monitor
.\install-to-project.ps1

# æ–¹å¼ 2: ç›´æ¥æŒ‡å®šè·¯å¾„
.\install-to-project.ps1 -TargetDir "D:\your-project"
```

### macOS / Linux / Git Bash

```bash
# æ–¹å¼ 1: äº¤äº’å¼å®‰è£…ï¼ˆæ¨èï¼‰
cd /path/to/context-monitor
./install-to-project.sh

# æ–¹å¼ 2: ç›´æ¥æŒ‡å®šè·¯å¾„
./install-to-project.sh /path/to/your-project
```

---

## ğŸ“‹ å®‰è£…å†…å®¹

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š

### 1. åˆ›å»ºç›®å½•ç»“æ„
```
your-project/
â”œâ”€â”€ .mcp.json                        # MCP server é…ç½®ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
â””â”€â”€ .claude/
    â”œâ”€â”€ hooks/
    â”‚   â””â”€â”€ capture-session-info.py  # SessionStart hook
    â”œâ”€â”€ mcp-servers/
    â”‚   â””â”€â”€ context-monitor/
    â”‚       â””â”€â”€ server.py            # MCP server
    â”œâ”€â”€ settings.local.json          # Hook é…ç½®
    â””â”€â”€ state/                       # ä¼šè¯çŠ¶æ€ä¿å­˜ç›®å½•
```

### 2. é…ç½®æ–‡ä»¶

#### `.mcp.json` (é¡¹ç›®æ ¹ç›®å½•)
```json
{
  "mcpServers": {
    "context-monitor": {
      "type": "stdio",
      "command": "python",
      "args": [".claude/mcp-servers/context-monitor/server.py"],
      "env": {}
    }
  }
}
```

#### `.claude/settings.local.json`
```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup|resume",
        "hooks": [
          {
            "type": "command",
            "command": "python \"$CLAUDE_PROJECT_DIR/.claude/hooks/capture-session-info.py\"",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
```

**è¯´æ˜**:
- `.mcp.json` å¿…é¡»æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œä¸æ˜¯ `.claude` æ–‡ä»¶å¤¹ä¸‹
- `matcher: "startup|resume"` - åœ¨æ–°ä¼šè¯å¯åŠ¨æˆ–æ¢å¤ä¼šè¯æ—¶éƒ½è¿è¡Œ hook
- Windows ä½¿ç”¨ `python`ï¼ŒmacOS/Linux ä½¿ç”¨ `python3`

---

## âœ… éªŒè¯å®‰è£…

### 1. å¯åŠ¨ Claude Code

```bash
cd /path/to/your-project
claude
```

### 2. é¦–æ¬¡å¯åŠ¨ä¼šæç¤ºæ‰¹å‡† MCP server

Claude Code ä¼šæ˜¾ç¤ºå®‰å…¨æç¤ºï¼Œè¦æ±‚æ‰¹å‡† `context-monitor` MCP serverã€‚ç‚¹å‡»"æ‰¹å‡†"ç»§ç»­ã€‚

### 3. æµ‹è¯•ç›‘æ§

åœ¨å¯¹è¯ä¸­è¾“å…¥ï¼š
```
è¯·æ£€æŸ¥å½“å‰ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡
```

é¢„æœŸè¾“å‡ºï¼š
```json
{
  "usage_percent": 15.3,
  "status": "âœ… SAFE",
  "recommendation": "Context usage is healthy. Continue working normally."
}
```

---

## ğŸ”§ æ‰‹åŠ¨å®‰è£…ï¼ˆå¯é€‰ï¼‰

å¦‚æœè‡ªåŠ¨è„šæœ¬å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨å®‰è£…ï¼š

### 1. å¤åˆ¶æ–‡ä»¶

```bash
# åˆ›å»ºç›®å½•
mkdir -p /path/to/your-project/.claude/hooks
mkdir -p /path/to/your-project/.claude/mcp-servers/context-monitor
mkdir -p /path/to/your-project/.claude/state

# å¤åˆ¶æ–‡ä»¶
cp .claude/hooks/capture-session-info.py /path/to/your-project/.claude/hooks/
cp .claude/mcp-servers/context-monitor/server.py /path/to/your-project/.claude/mcp-servers/context-monitor/
```

### 2. åˆ›å»ºé…ç½®æ–‡ä»¶

åˆ›å»º `/path/to/your-project/.mcp.json`ï¼š
```json
{
  "mcpServers": {
    "context-monitor": {
      "type": "stdio",
      "command": "python",
      "args": [".claude/mcp-servers/context-monitor/server.py"],
      "env": {}
    }
  }
}
```

åˆ›å»º `/path/to/your-project/.claude/settings.local.json`ï¼š
```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup|resume",
        "hooks": [
          {
            "type": "command",
            "command": "python \"$CLAUDE_PROJECT_DIR/.claude/hooks/capture-session-info.py\"",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### Q: Windows ä¸Š SessionStart hook ä¸æ‰§è¡Œ

**A**: è¿™æ˜¯ Claude Code åœ¨ Windows ä¸Šçš„å·²çŸ¥ bug ([Issue #14219](https://github.com/anthropics/claude-code/issues/14219))ã€‚

**Workaround**: åœ¨ CLAUDE.md ä¸­æ·»åŠ å¼ºåˆ¶æŒ‡ä»¤ï¼Œè®© Claude åœ¨ä¼šè¯å¼€å§‹æ—¶ä¸»åŠ¨è°ƒç”¨ `check_context_usage`ã€‚

### Q: Python æ‰¾ä¸åˆ°

**A**: å®‰è£… Python 3ï¼š
- macOS: `brew install python3`
- Ubuntu: `sudo apt install python3`
- Windows: https://www.python.org/downloads/

Windows ç”¨æˆ·ç¡®ä¿ Python åœ¨ PATH ä¸­ï¼š
```powershell
python --version
```

### Q: MCP server å·¥å…·ä¸å¯ç”¨

**A**: æ£€æŸ¥ï¼š
1. `.mcp.json` æ˜¯å¦åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆä¸æ˜¯ `.claude` æ–‡ä»¶å¤¹ä¸‹ï¼‰
2. é‡å¯ Claude Code
3. é¦–æ¬¡ä½¿ç”¨æ—¶æ‰¹å‡† MCP server

### Q: ç°æœ‰é…ç½®æ–‡ä»¶ä¼šè¢«è¦†ç›–å—ï¼Ÿ

**A**: ä¼šè‡ªåŠ¨å¤‡ä»½ä¸º `settings.local.json.backup` å’Œ `.mcp.json.backup`

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](./README.md) - é¡¹ç›®æ¦‚è§ˆ
- [æ•´åˆå·¥ä½œæµæŒ‡å—.md](./æ•´åˆå·¥ä½œæµæŒ‡å—.md) - ä½¿ç”¨æŒ‡å—
- [ä¸Šä¸‹æ–‡ç›‘æ§è¯¦è§£.md](./ä¸Šä¸‹æ–‡ç›‘æ§è¯¦è§£.md) - è¯¦ç»†è¯´æ˜

---

**æ³¨æ„**: Context Monitor å¿…é¡»åœ¨æ¯ä¸ªé¡¹ç›®ä¸­å•ç‹¬å®‰è£…ï¼Œå› ä¸ºå®ƒéœ€è¦é¡¹ç›®ç‰¹å®šçš„æ–‡ä»¶å’Œé…ç½®ã€‚
